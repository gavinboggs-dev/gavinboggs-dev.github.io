<!DOCTYPE HTML>

<html>
	<head>
		<title>Climbing and Skiing - Gavin Boggs</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<link rel="stylesheet" href="assets/css/main.css" />
	</head>
	<body>

		<!-- Header -->
			<header id="header">
				<h1><strong>Climbing and Skiing</strong></h1>
				<nav id="nav">
					<ul>
						<li><a href="index.html">Home</a></li>
						<li><a href="engineering.html">Engineering and Data</a></li>
					</ul>
				</nav>
			</header>

			<a href="#menu" class="navPanelToggle"><span class="fa fa-bars"></span></a>

		<!-- Main -->
			<section id="main" class="wrapper">
				<div class="container">
					<a class="image fit"><img src="images/hoodview.jpg" alt="" /></a>
					<h2>Climbing Resume</h2>
					<ul class="actions small">
						<li style="margin-bottom:10px">Filter:</li>
						<li><a class="button small" onclick="loadData('',processTable)">All</a></li>
						<li><a class="button alt small" onclick="loadData('Alpine',processTable)">Alpine</a></li>
						<li><a class="button alt small" onclick="loadData('Rock,Trad,Sport',processTable)">Rock</a></li>
						<li><a class="button alt small" onclick="loadData('Ice',processTable)">Ice</a></li>
						<li><a class="button alt small" onclick="loadData('Ski',processTable)">Ski</a></li>
					</ul>
					<div class="table-wrapper">
						<table id="table">
							<thead>
								<tr>
									<th></th>
									<th style="width:140px">Date</th>
									<th style="width:40%">Route</th>
									<th>Location</th>
								</tr>
							</thead>
						</table>
					</div>
					<div style="padding-top:2em" class="row">
							<ul class="actions">
								<li><a href="documents/GavinBoggsClimbingResume_2019.pdf" target="_blank" class="button">Climbing Resume (PDF)</a></li>
							</ul>
					</div>
				</div>
			</section>

		<!-- Footer -->
			<footer id="footer">
				<div class="container">
					<ul class="icons">
						<li><a href="mailto:gavin@gavinboggs.com" class="icon fa-send" onclick="mailto(this);event.preventDefault()"></a></li>
						<li><a href="https://www.linkedin.com/in/gavinboggs/" target="_blank" class="icon fa-linkedin"></a></li>
					</ul>
					<ul class="copyright">
						<li>&copy; Gavin Boggs 2020</li>
					</ul>
				</div>
			</footer>

		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script>
				loadData("", processTable);
				
				function loadData(typeFilter, callback) {
					$('#table tr').remove();
					//var fileLocation = "/";
					var typeFilterArray = typeFilter.split(",");
					var fileLocation = "http://localhost/~gavin/";
					$.getJSON(fileLocation + "documents/climbs.json",
					function (data) {
						var tr;
						var routeType;
						for (var i = 0; i < data.length; i++) {
							//console.log(
							if (typeof data[i]["Route Type"] === "undefined") {
								routeType = "undefined";
							}
							else {
								routeType = data[i]["Route Type"];
							}
							if ((typeFilter=="") | (typeFilterArray.some(v => routeType.includes(v)))) {
								tr = $('<tr/>');
								tr.addClass("collapsible");
								tr.append("<td class=\"collapseIndicator\">+");
								tr.append("<td>" + data[i].Date);
								tr.append("<td>" + data[i].Route);
								tr.append("<td>" + data[i].Location);
								cont = $('<tr/>');
								cont.addClass("content");
								cont.append("<td>");
								str = "";
								if ("Images" in data[i]) {
									console.log("images: data[i].Images.length")
									str = str.concat("<div class=\"image right thumb\">\n");
									for (var j = 0; j < data[i].Images.length; j++) {
										str = str.concat("<a class=\"image right\"><img src=" + fileLocation + "images/" + data[i].Images[j] + "></a>\n");
									}
									str = str.concat("</div>");
								}
								$.each(data[i], function( index, value ) {
									if ($.inArray(index,["Route","Date","Location","Images"]) < 0) {
										str = str.concat("<i>" + index + ":</i> " + value + "<br>");
									}
								});
								cont.append("<td colspan='4'>" + str);
								$('#table').append(tr);
								$('#table').append(cont);
							}
						}
						callback()
					});
                }
				//Control opening and closing of table rows
				function processTable(){
					console.log("start process");
					var coll = document.getElementsByClassName("collapsible");
					var i;
					for (i = 0; i < coll.length; i++) {
						console.log("item");
						coll[i].addEventListener("click", function() {
							this.classList.toggle("active");
							var content = this.nextElementSibling;
							if (content.style.display === "contents") {
								content.style.display = "none";
								this.firstElementChild.innerHTML = "+";
							}
							else {
								content.style.display = "contents";
								this.firstElementChild.innerHTML = "-";
							}
						});
					}
					console.log("end process");
					console.log(coll.length);
				}
			</script>
			
			<script src="assets/js/skel.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>

			<script>
				// Open mailto links in a new tab
				function mailto(th) {
					var url = th.getAttribute('href');
					window.open(url);
				}
			</script>
	</body>
</html>